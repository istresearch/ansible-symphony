# Alert when there is a sudden spike in the volume of events

# (Required)
# Elasticsearch host
es_host: {{elastalert_es_host}}

# (Required)
# Elasticsearch port
es_port: {{elastalert_es5_port}}

# (OptionaL) Connect with SSL to elasticsearch
#use_ssl: True

# (Optional) basic-auth username and password for elasticsearch
#es_username: someusername
#es_password: somepassword

# (Required)
# Rule name, must be unique
name: Justpaste spike

# (Required)
# Type of alert.
# the spike rule type compares the number of events within two sliding windows to each other
type: spike

# (Required)
# Index to search, wildcard supported
index: prod-darpa-*

# (Required, spike specific)
# The minimum number of events to be used as a baseline
# For example, if there are only 2 eventss between 12:00 and 2:00, and 20 between 2:00 and 4:00
# This rule will ignore that 'spike', because the reference window did not meet the threshold of 5
threshold: 5

# (Required, spike specific)
# The size of the window used to determine average event frequency
# We use two sliding windows each of size timeframe
# To measure the 'reference' rate and the current rate
timeframe:
  hours: 1

# (Required, spike specific)
# The spike rule matches when the current window contains spike_height times more
# events than the reference window
spike_height: 2

# (Required, spike specific)
# The direction of the spike
# 'up' matches only spikes, 'down' matches only troughs
# 'both' matches both spikes and troughs
spike_type: "up"

# (Required)
# A list of elasticsearch filters used for find events
# These filters	 are joined with AND and nested in a filtered query
# For more info: http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/query-dsl.html
filter:
- query:
    query_string:
      query: "d_rule_values: justpaste"

# (Required)
# The alert is use when a match is found
alert:
- {{elastalert_slack_alerter}}

# (Required, Slack)
# Slack web hook
slack_hook: {{slackbot}}

# (Required, Slack)
# Slack, channel

slack_channel: {{elastalert_slack_channel}}

use_local_time: {{elastalert_local_time}}
