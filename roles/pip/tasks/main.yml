---
# file: roles/pip/tasks/main.yml

- name: download get-pip.py
  get_url:
    url=https://bootstrap.pypa.io/get-pip.py
    dest=/tmp/get-pip.py
    mode=0755
  tags: pip

- name: python install pip
  shell: python /tmp/get-pip.py
  tags: pip

- name: delete temporary pip file
  file:
    path: /tmp/get-pip.py
    state: absent
  ignore_errors: yes
  tags: pip

- name: configure pip to use the local repository
  template:
    src: pip.conf.j2
    dest: /etc/pip.conf
    mode: 0775
  when: pip_local
  tags: pip

- name: pip environment configuration
  lineinfile:
    dest: /etc/environment
    line: "export PIP_CONFIG_FILE=/etc/pip.conf"
  when: pip_local
  tags: pip

- name: Set fact pip_has_run
  set_fact:
    pip_has_run: true
